/**
 * @license addEventListener polyfill 1.0 / Eirik Backer / MIT Licence
 * https://gist.github.com/2864711/946225eb3822c203e8d6218095d888aac5e1748e
 *
 * sounisi5011 version:
 * http://qiita.com/sounisi5011/items/a8fc80e075e4f767b79a#11
 */
!function(e,t,n){if((!e.addEventListener||!e.removeEventListener)&&e.attachEvent&&e.detachEvent){var r=function(e){return"function"==typeof e},a=function(e,t){var r=t[n];if(r)for(var a,i=r.length;i--;)if(a=r[i],a[0]===e)return a[1]},i=function(e,t,r){var i=t[n]||(t[n]=[]);return a(e,t)||(i[i.length]=[e,r],r)},o=function(e){var n=t[e];t[e]=function(e){return u(n(e))}},v=function(n,a){if(r(a)){var o=this;o.attachEvent("on"+n,i(o,a,function(n){n=n||e.event,n.preventDefault=n.preventDefault||function(){n.returnValue=!1},n.stopPropagation=n.stopPropagation||function(){n.cancelBubble=!0},n.target=n.target||n.srcElement||t.documentElement,n.currentTarget=n.currentTarget||o,n.timeStamp=n.timeStamp||(new Date).getTime(),a.call(o,n)}))}},c=function(e,t){if(r(t)){var n=this,i=a(n,t);i&&n.detachEvent("on"+e,i)}},u=function(e){var t=e.length;if(t)for(;t--;)e[t].addEventListener=v,e[t].removeEventListener=c;else e.addEventListener=v,e.removeEventListener=c;return e};if(u([t,e]),"Element"in e){var f=e.Element;f.prototype.addEventListener=v,f.prototype.removeEventListener=c}else t.attachEvent("onreadystatechange",function(){u(t.all)}),o("getElementsByTagName"),o("getElementById"),o("createElement"),u(t.all)}}(window,document,"x-ms-event-listeners");